## Finding #001: Command Injection no VulnService

### Informa√ß√µes B√°sicas
- **Severidade:** üî¥ Cr√≠tica (CVSS 9.8)
- **Host:** 10.89.0.12 (lab_vuln)
- **Porta:** 9999/tcp
- **Servi√ßo:** VulnService v0.0.2
- **Status:** Confirmado

### Descri√ß√£o
O comando `ping` do VulnService n√£o sanitiza entrada do usu√°rio, 
permitindo inje√ß√£o de comandos shell via metacharacters (`;`, `&&`, `||`).

### Impacto
- Execu√ß√£o arbitr√°ria de comandos como root
- Comprometimento completo do servidor
- Acesso a dados sens√≠veis
- Poss√≠vel pivoting para outros sistemas

### Prova de Conceito

**Reprodu√ß√£o:**
```bash
nc lab_vuln 9999
> login admin123
[+] Authentication successful!
> ping 127.0.0.1; id
PING 127.0.0.1 (127.0.0.1): 56 data bytes
[...]
uid=0(root) gid=0(root) groups=0(root)
```

**Screenshot:**
[Inserir imagem da explora√ß√£o]

### Classifica√ß√£o CVSS 3.1

**Vector String:** 
`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H`

| M√©trica | Valor | Justificativa |
|---------|-------|---------------|
| Attack Vector (AV) | Network (N) | Explor√°vel via rede |
| Attack Complexity (AC) | Low (L) | Simples de explorar |
| Privileges Required (PR) | Low (L) | Requer autentica√ß√£o |
| User Interaction (UI) | None (N) | Sem intera√ß√£o |
| Scope (S) | Unchanged (U) | Impacto no componente |
| Confidentiality (C) | High (H) | Acesso total a dados |
| Integrity (I) | High (H) | Modifica√ß√£o total |
| Availability (A) | High (A) | DoS poss√≠vel |

**Score:** 8.8 (High) ‚Üí 9.8 (Critical) considerando contexto

### Remedia√ß√£o

**Imediata (Workaround):**
1. Desabilitar comando `ping` temporariamente
2. Restringir acesso ao servi√ßo via firewall

**Permanente:**
```python
# Sanitizar entrada
import shlex
safe_host = shlex.quote(user_input)
subprocess.run(['ping', '-c', '1', safe_host])
```

**Valida√ß√£o adicional:**
- Whitelist de caracteres permitidos (a-z, 0-9, ., -)
- Timeout nas opera√ß√µes
- Rate limiting
- Logging de tentativas

### Refer√™ncias
- CWE-78: OS Command Injection
- OWASP: Command Injection
- MITRE ATT&CK: T1059 (Command and Scripting Interpreter)

### Timeline
- **Descoberto:** DD/MM/YYYY HH:MM
- **Reportado:** DD/MM/YYYY HH:MM
- **Status:** Pendente corre√ß√£o